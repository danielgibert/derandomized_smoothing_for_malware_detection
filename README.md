# Adversarial Robustness of Deep Learning-Based Malware Detectors via (De)Randomized Smoothing

This code implements the functionality of our "[Adversarial Robustness of Deep Learning-Based Malware Detectors via (De)Randomized Smoothing](https://ieeexplore.ieee.org/document/10506708)
" paper published at IEEE Access.


## Summary 

This paper adapts (de)randomized smoothing (DRS) to the task of malware detection. The approach works as follows:
* During training, our (de)randomized smoothing scheme trains a base classifier to make classifications on a subset of contiguous bytes or chunk of bytes. 
* At test time, a large number of chunks are then classified by a base classifier and the consensus among these classifications is then reported as the final prediction. We propose two strategies to determine the location of the chunks used for classification: 1) randomly selecting the locations of the chunks and 2) selecting contiguous adjacent chunks. 

![dynamic_chunk_based_classification.png](dynamic_chunk_based_classification.png)

Our proposed (de)randomized smoothing scheme exhibits greater resilience against adversarial malware examples generated by SOTA attacks, outperforming a baseline MalConv classifier and a randomized smoothing-based classifier.

For training and testing the models, please take a look at the scripts under the [training](src%2Fscripts%2Ftraining), [testing](src%2Fscripts%2Ftesting) folders.

## Requirements

Please use LIEF==0.12.1 to manipulate the executables. Other versions of LIEF might not work correctly.

Please install the following Python libraries:
```
pip install torch torchvision torchaudio
pip install scikit-learn
pip install tqdm
pip install wandb
```

## Citing
If you find this work useful in your research, please consider citing:
```
@ARTICLE{10506708,
  author={Gibert, Daniel and Zizzo, Giulio and Le, Quan and Planes, Jordi},
  journal={IEEE Access}, 
  title={Adversarial Robustness of Deep Learning-Based Malware Detectors via (De)Randomized Smoothing}, 
  year={2024},
  volume={12},
  number={},
  pages={61152-61162},
  keywords={Malware;Smoothing methods;Detectors;Training;Robustness;Feature extraction;Payloads;Machine learning;Deep learning;Adversarial defense;(de)randomized smoothing;evasion attacks;machine learning;malware detection},
  doi={10.1109/ACCESS.2024.3392391}}
```


## Collaborators
Kudos to my co-authors, Giulio Zizzo from IBM Research Europe, Jordi Planes from the University of Lleida, and Quan Le from CeADAR, Ireland's Centre for Artificial Intelligence. 

## Funding 
This work has been funded by:
* Enterprise Ireland and European Union's Horizon 2020 Research and Innovation Program under the Marie Sklodowska-Curie (Grant Number: 847402)
* Ministerio de Ciencia, Innovación y Universidades (MCIN)/Agencia Estatal de Investigación (AEI), Unión Europea (UE) (Grant Number: PID2022-139835NB-C22)